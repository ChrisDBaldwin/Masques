{"id":"masque-1em","title":"Whoami Command","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-18T13:05:26.180883-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.240658-06:00","closed_at":"2026-01-18T13:08:11.240658-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold","dependencies":[{"issue_id":"masque-1em","depends_on_id":"masque-3cb","type":"blocks","created_at":"2026-01-18T13:05:33.821053-06:00","created_by":"chris"}]}
{"id":"masque-1in","title":"Implement fractal stats command","description":"## Context\n\nThe stats command provides observability at every level of the fractal model. Same query patterns, different aggregation scopes.\n\n## Fractal Levels\n\n```\nL5: System     â”€â”€â”€ Overall registry health\nL4: Ring       â”€â”€â”€ Trust tier aggregates  \nL3: Skill      â”€â”€â”€ Cross-masque skill analysis\nL2: Masque     â”€â”€â”€ Single identity over time\nL1: Session    â”€â”€â”€ Individual don/doff cycle\n```\n\n## CLI Design\n\n```bash\nmasque stats                           # System level (default)\nmasque stats --level system            # Explicit system level\nmasque stats --level ring              # By trust tier\nmasque stats --level ring --ring player # Specific ring\nmasque stats --level skill             # By skill\nmasque stats --level skill --skill \"skill://programming/zig\"\nmasque stats --level masque            # Per-masque breakdown\nmasque stats --level masque --name Codesmith  # Specific masque\nmasque stats --level session --id \u003cuuid\u003e      # Single session\n```\n\n## Queries Per Level\n\n### L5: System\n```sql\nSELECT \n  count(DISTINCT masque_name) as total_masques,\n  count(*) as total_sessions,\n  avg(rating_numeric(rating)) as avg_rating,\n  count(*) FILTER (WHERE rating = 'e') as exponential_sessions\nFROM sessions;\n```\n\n### L4: Ring  \n```sql\nSELECT \n  m.ring,\n  count(DISTINCT s.masque_name) as masques,\n  count(*) as sessions,\n  avg(rating_numeric(s.rating)) as avg_rating\nFROM sessions s\nJOIN masques m ON s.masque_name = m.name\nGROUP BY m.ring;\n```\n\n### L3: Skill\n```sql\nSELECT\n  ms.skill_uri,\n  ms.level as claimed_level,\n  count(*) as sessions,\n  avg(rating_numeric(s.rating)) as actual_performance\nFROM sessions s\nJOIN masque_skills ms ON s.masque_name = ms.masque_name\nGROUP BY ms.skill_uri, ms.level;\n```\n\n### L2: Masque\n```sql\nSELECT\n  masque_name,\n  count(*) as sessions,\n  avg(rating_numeric(rating)) as avg_rating,\n  max(ended_at) as last_active\nFROM sessions\nGROUP BY masque_name;\n```\n\n### L1: Session\n```sql\nSELECT * FROM sessions WHERE id = ?;\n```\n\n## Output Format\n\n```\n=== System Stats ===\n\nTotal Masques:    12\nTotal Sessions:   847\nAvg Rating:       1.3 (between + and *)\n\nRating Distribution:\n  e  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  12%\n  *  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  38%\n  +  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  31%\n  /  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   8%\n  -  â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘  11%\n\nTop Performers:\n  1. Codesmith     (2.1 avg, 156 sessions)\n  2. Architect     (1.9 avg, 89 sessions)\n  3. Reviewer      (1.7 avg, 203 sessions)\n```\n\n## Implementation Notes\n\n- Use DuckDB's read_json_auto for masques + read_parquet for sessions\n- JOIN across file types in single query\n- Cache nothing â€” always query fresh (DuckDB is fast enough)\n- Consider sparklines for terminal viz\n\n## Success Criteria\n\n- Same mental model at every level (just change GROUP BY)\n- Fast enough for interactive use (\u003c100ms)\n- Clear output showing the aggregation level\n- Drill-down: stats output suggests next-level queries","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:42:53.173321-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.900533-06:00","closed_at":"2026-01-17T00:32:02.900533-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-3cb","title":"Session State File","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T13:05:25.909152-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.213028-06:00","closed_at":"2026-01-18T13:08:11.213028-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold","dependencies":[{"issue_id":"masque-3cb","depends_on_id":"masque-9hy","type":"blocks","created_at":"2026-01-18T13:05:33.694035-06:00","created_by":"chris"}]}
{"id":"masque-5z8","title":"Define skill registry schema","description":"## Context\n\nSkills are referenced by masques via URIs (skill://domain/name), but we haven't defined what a skill IS yet. The skill registry enables L3 (Skill) observability.\n\n## Fractal Position\n\n**Level**: L3 foundation\n**Purpose**: Enable cross-masque skill analysis\n\nWithout a skill registry:\n- Can't validate skill URIs in masques\n- Can't aggregate performance BY skill\n- Can't answer \"which masques claim Zig expertise?\"\n- Can't compare claimed level vs actual performance\n\n## Proposed Schema\n\n```json\n{\n  \"uri\": \"skill://programming/zig\",\n  \"domain\": \"programming\",\n  \"name\": \"zig\",\n  \"description\": \"Systems programming in Zig\",\n  \"levels\": {\n    \"novice\": \"Can write basic programs with guidance\",\n    \"competent\": \"Handles standard tasks independently\", \n    \"proficient\": \"Complex cases, teaches others\",\n    \"expert\": \"Deep mastery, defines best practices\",\n    \"master\": \"Shapes the field, creates new approaches\"\n  },\n  \"related\": [\n    \"skill://programming/c\",\n    \"skill://design/systems\"\n  ]\n}\n```\n\n## Directory Structure\n\n```\nentities/\nâ”œâ”€â”€ masques/*.masque.json\nâ””â”€â”€ skills/*.skill.json      # NEW\n```\n\n## Queries Enabled\n\n```sql\n-- All masques claiming a skill\nSELECT m.name, ms.level\nFROM read_json_auto('entities/masques/*.json') m,\n     unnest(m.skills) as ms\nWHERE ms.uri = 'skill://programming/zig';\n\n-- Performance by skill (joins sessions)\nSELECT \n  ms.uri,\n  ms.level,\n  avg(rating_numeric(s.rating)) as actual_perf\nFROM sessions s\nJOIN masque_skills ms ON ...\nGROUP BY ms.uri, ms.level;\n```\n\n## Implementation Steps\n\n1. Create schema file: schemas/skill.schema.yaml\n2. Create initial skills (zig, systems-design, etc.)\n3. Update validate command to check skill URIs exist\n4. Add to stats --level skill queries\n\n## Open Questions\n\n- Auto-create skills on first reference, or require pre-definition?\n- Skill hierarchy? (programming â†’ programming/zig)\n- Skill dependencies? (zig requires systems-thinking)\n- Who defines skill levels? Global or per-masque interpretation?\n\n## Success Criteria\n\n- Skills are first-class entities with definitions\n- Masque validation checks skill URIs exist\n- Stats can aggregate by skill across all masques","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:44:54.163664-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.899689-06:00","closed_at":"2026-01-17T00:32:02.899689-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-70k","title":"Implement masque validate command","description":"## Context\n\nThe `validate` command checks masque JSON files against the schema. This is the foundation for data integrity across all observability levels.\n\n## Fractal Position\n\n**Level**: Schema/Foundation\n**Feeds into**: Every other level depends on valid masque definitions\n\nWithout validation, the registry can contain malformed masques that break queries at Session, Masque, Skill, Ring, and System levels.\n\n## Implementation\n\n1. Parse JSON file with std.json\n2. Check required fields: name, index, version, ring, intent, lens\n3. Validate field types and constraints:\n   - version: semver format (x.y.z)\n   - ring: enum (admin|player|guest|outsider)\n   - skills[].level: enum (novice|competent|proficient|expert|master)\n   - skills[].uri: pattern skill://domain/name\n4. Report errors with line numbers if possible\n\n## CLI\n\n```bash\nmasque validate                           # Validate all in entities/masques/\nmasque validate entities/masques/foo.json # Validate specific file\n```\n\n## Success Criteria\n\n- Invalid masques are rejected before entering the registry\n- Clear error messages pointing to the problem\n- Exit code 0 on success, non-zero on failure","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:40:52.596767-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.902931-06:00","closed_at":"2026-01-17T00:32:02.902931-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-7l7","title":"Doff Command","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T13:05:26.084356-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.231547-06:00","closed_at":"2026-01-18T13:08:11.231547-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold","dependencies":[{"issue_id":"masque-7l7","depends_on_id":"masque-3cb","type":"blocks","created_at":"2026-01-18T13:05:33.78042-06:00","created_by":"chris"}]}
{"id":"masque-8w4","title":"Plugin Scaffold","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T13:05:25.73193-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.189914-06:00","closed_at":"2026-01-18T13:08:11.189914-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold"}
{"id":"masque-8yi","title":"Set up Parquet event storage","description":"## Context\n\nSession events need persistent storage. Parquet is the right format:\n- Columnar (efficient for analytics)\n- Compressed (small footprint)\n- DuckDB reads it natively\n- Append-friendly (new sessions add rows)\n\n## Fractal Position\n\n**Level**: Infrastructure (enables L1-L5)\n**Purpose**: Store the raw events that feed all aggregations\n\nWithout event storage, there's no observability. Parquet is the foundation.\n\n## Implementation\n\n### Directory Structure\n```\nevents/\nâ”œâ”€â”€ sessions.parquet    # All session records\nâ””â”€â”€ ratings.parquet     # Standalone ratings (outside sessions)\n```\n\n### Parquet Writing in Zig\n\nDuckDB can write Parquet via SQL:\n```sql\nCOPY (SELECT ...) TO 'events/sessions.parquet' (FORMAT PARQUET);\n```\n\nOr append:\n```sql\nINSERT INTO read_parquet('events/sessions.parquet') \nSELECT ...;\nCOPY ... TO 'events/sessions.parquet';\n```\n\n### Schema\n\nsessions.parquet:\n- id: UUID\n- masque_name: VARCHAR\n- masque_version: VARCHAR  \n- intent: VARCHAR\n- started_at: TIMESTAMP\n- ended_at: TIMESTAMP (nullable)\n- rating: VARCHAR (nullable, enum +/-//*\\/e)\n- rating_notes: VARCHAR (nullable)\n\n### Bootstrapping\n\nFirst session needs to CREATE the parquet file:\n```sql\nCOPY (\n  SELECT \n    gen_random_uuid() as id,\n    'Codesmith' as masque_name,\n    ...\n) TO 'events/sessions.parquet' (FORMAT PARQUET);\n```\n\nSubsequent sessions append by:\n1. Read existing parquet\n2. Union with new row\n3. Write back\n\nOr use DuckDB's native append mode if available.\n\n## Alternative: JSONL\n\nSimpler but less efficient:\n```\nevents/sessions.jsonl  # One JSON object per line\n```\n\nPros: Human-readable, easy append, git-diffable\nCons: Slower queries, larger files, no compression\n\nCould start with JSONL and migrate to Parquet when performance matters.\n\n## Success Criteria\n\n- Events persist across CLI invocations\n- DuckDB can query events with standard SQL\n- Append is fast (no full rewrite)\n- File size stays reasonable (\u003c1MB for thousands of sessions)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:47:47.335311-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.898795-06:00","closed_at":"2026-01-17T00:32:02.898795-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-920","title":"TUI masque portrait renderer","description":"## Context\n\nRender a masque as a visual \"portrait\" in the terminal. Part identity card, part character sheet, part artistic expression.\n\n## Vision\n\n```\nâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\nâ”‚                                          â”‚\nâ”‚      â–‘â–ˆâ–€â–€â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–€â–‘â–ˆâ–€â–€â–‘â–ˆâ–„â–ˆâ–‘â–€â–ˆâ–€â–‘â–€â–ˆâ–€â–‘â–ˆâ–‘â–ˆ  â”‚\nâ”‚      â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–€â–‘â–€â–€â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–‘â–ˆâ–€â–ˆ  â”‚\nâ”‚      â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–€â–‘â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–‘â–€â–‘â–‘â–€â–‘â–€  â”‚\nâ”‚                                          â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Ring: â–ˆâ–ˆâ–ˆâ–ˆ Player         â”‚\nâ”‚  â”‚  â•±â•²     â”‚   Index: #1                 â”‚\nâ”‚  â”‚ â•±  â•²    â”‚   Version: 0.1.0            â”‚\nâ”‚  â”‚â•± Zigâ•²   â”‚                             â”‚\nâ”‚  â”‚â•²    â•±   â”‚   \"every line should teach\" â”‚\nâ”‚  â”‚ â•²  â•±    â”‚                             â”‚\nâ”‚  â”‚  â•²â•±     â”‚   Skills:                   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     zig â–“â–“â–“â–“â–‘ competent     â”‚\nâ”‚                  systems â–“â–“â–“â–“â–“ proficient â”‚\nâ”‚                  building â–“â–“â–“â–“â–“â–“ expert  â”‚\nâ”‚                                          â”‚\nâ”‚  Performance: â˜… â˜… â˜… â˜† â˜†  (3 sessions)    â”‚\nâ”‚  Last active: 2 hours ago                â”‚\nâ”‚                                          â”‚\nâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\n```\n\n## Implementation Approach\n\n### Phase 1: Raw ANSI\n- Box-drawing characters (â”€â”‚â•­â•®â•¯â•°)\n- ANSI color codes (\\x1b[38;5;Nm)\n- Block elements (â–‘â–’â–“â–ˆ)\n- No dependencies, just std.io\n\n### Phase 2: Layout Engine\n- Measure terminal size (ioctl TIOCGWINSZ)\n- Flexible box model\n- Text wrapping\n\n### Phase 3: Theming\n- Ring determines color palette?\n  - Admin: red/gold\n  - Player: blue/silver\n  - Guest: green/bronze\n  - Outsider: gray/muted\n- Performance affects \"glow\" or border style\n\n## Technical Notes\n\n### ANSI Escape Codes\n```zig\nconst ESC = \"\\x1b[\";\nconst RESET = ESC ++ \"0m\";\nconst BOLD = ESC ++ \"1m\";\nconst FG_BLUE = ESC ++ \"34m\";\nconst BG_BLACK = ESC ++ \"40m\";\n// 256-color: ESC ++ \"38;5;{n}m\"\n// True color: ESC ++ \"38;2;{r};{g};{b}m\"\n```\n\n### Box Drawing\n```\nLight:  â”€ â”‚ â”Œ â” â”” â”˜ â”œ â”¤ â”¬ â”´ â”¼\nHeavy:  â” â”ƒ â” â”“ â”— â”› â”£ â”« â”³ â”» â•‹\nRounded: â•­ â•® â•¯ â•°\nDouble: â• â•‘ â•” â•— â•š â• â•  â•£ â•¦ â•© â•¬\n```\n\n### Block Elements\n```\nâ–‘ Light shade (25%)\nâ–’ Medium shade (50%)\nâ–“ Dark shade (75%)\nâ–ˆ Full block\nâ–€â–„ Half blocks (top/bottom)\n```\n\n## CLI\n\n```bash\nmasque portrait codesmith          # Render to terminal\nmasque portrait codesmith --ascii  # ASCII-only fallback\nmasque portrait codesmith --width 60\nmasque portrait codesmith --no-color\n```\n\n## Fractal Connection\n\nThe portrait is L2 (Masque level) visualization:\n- Shows identity (name, ring, version)\n- Shows skills with proficiency bars\n- Shows aggregated performance from L1 sessions\n- Could drill down to session list on keypress\n\n## Open Questions\n\n- ASCII art for masque \"icon\"? Generated or hand-drawn?\n- Animation? Subtle pulse for active sessions?\n- Interactive? Keypress to show lens, skills, history?\n- Export to PNG/SVG for sharing?\n\n## Why This Matters\n\nMasques are identities. Identities deserve portraits. A beautiful TUI rendering makes the abstract concrete â€” you SEE the masque before you don it.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:53:45.532893-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.89776-06:00","closed_at":"2026-01-17T00:32:02.89776-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-9hy","title":"Don Command","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-18T13:05:25.824508-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.203057-06:00","closed_at":"2026-01-18T13:08:11.203057-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold","dependencies":[{"issue_id":"masque-9hy","depends_on_id":"masque-8w4","type":"blocks","created_at":"2026-01-18T13:05:33.645432-06:00","created_by":"chris"}]}
{"id":"masque-9ta","title":"SessionStart Hook","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T13:05:25.99469-06:00","created_by":"chris","updated_at":"2026-01-18T13:08:11.222637-06:00","closed_at":"2026-01-18T13:08:11.222637-06:00","close_reason":"All Phase 1 MVP components implemented in plugin scaffold","dependencies":[{"issue_id":"masque-9ta","depends_on_id":"masque-3cb","type":"blocks","created_at":"2026-01-18T13:05:33.736905-06:00","created_by":"chris"}]}
{"id":"masque-i3c","title":"MaskTUI Factory: deterministic mask generator","description":"## Concept\n\nA MaskTUI factory that generates a unique, deterministic visual mask for any masque. Same masque â†’ same mask, every time. The mask IS the masque's face.\n\n## Terminology\n\n- **Masque**: The identity definition (JSON file with skills, lens, ring, etc.)\n- **Mask**: The visual TUI representation (unicode art)\n\n## Deterministic Generation\n\nThe mask is derived from masque attributes, not random. Inputs that affect the visual:\n\n| Attribute | Affects |\n|-----------|---------|\n| name | Overall shape seed, title text |\n| index | Symmetry patterns |\n| ring | Color palette, border style |\n| skills | Eye designs, decorative elements |\n| performance.score | Expression (smile/neutral/frown) |\n| attributes.* | Embellishments, motifs |\n\n### Hash-based Seeding\n\n```zig\nconst seed = hash(masque.name ++ masque.version);\nvar rng = std.rand.DefaultPrng.init(seed);\n// Now all \"random\" choices are deterministic\n```\n\n## Base Skill\n\nEvery masque implicitly has the ability to render itself:\n\n```yaml\nskills:\n  - uri: skill://meta/self-render\n    level: master  # Always master at being itself\n```\n\nThis is intrinsic â€” not declared, just present. When you `masque portrait \u003cname\u003e`, the masque renders its own face.\n\n## Visual Components\n\n### 1. Mask Shape (derived from index + name hash)\n```\n    Venetian          Kabuki           Comedy/Tragedy\n    \n    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®      â•±â–”â–”â–”â–”â–”â–”â–”â•²        â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\n   â•±           â•²    â”‚ â•â•â•â•â•â•â• â”‚       â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â•® â”‚\n  â”‚  â—      â—    â”‚    â”‚ â—¯     â—¯ â”‚      â•±  â”‚ â—¡   â—¡ â”‚  â•²\n  â”‚     â–½      â”‚    â”‚    â–²    â”‚     â”‚   â”‚   â—¡   â”‚   â”‚\n   â•²  â•°â”€â”€â”€â•¯   â•±     â”‚  â•°â•â•â•â•¯  â”‚      â•²  â•°â”€â”€â”€â”€â”€â”€â”€â•¯  â•±\n    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯      â•²_______â•±        â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\n```\n\n### 2. Eyes (derived from top 2 skills)\n```\n    novice      competent    proficient    expert       master\n    \n      â€¢            â—¦            â—            â—‰           â˜…\n     (.)          (o)          (â—)          (â—ˆ)         (âœ¦)\n```\n\n### 3. Expression (derived from performance score)\n```\n    e/â˜…         *          +           /           -\n    \n   â•°â”€â”€â”€â•¯      â•°â”€â”€â”€â•¯      â”€â”€â”€â”€â”€      â•­â”€â”€â”€â•®      â•­â”€â”€â”€â•®\n   smile      grin       neutral    uncertain   frown\n```\n\n### 4. Border/Frame (derived from ring)\n```\n    admin         player        guest         outsider\n    \n   â•”â•â•â•â•â•â•—       â”â”â”â”â”â”â”“       â•­â”€â”€â”€â”€â”€â•®        +-----+\n   â•‘     â•‘       â”ƒ     â”ƒ       â”‚     â”‚        |     |\n   â•šâ•â•â•â•â•â•       â”—â”â”â”â”â”â”›       â•°â”€â”€â”€â”€â”€â•¯        +-----+\n   double        heavy         rounded        ascii\n   gold/red      blue/silver   green/bronze   gray\n```\n\n### 5. Decorations (derived from attributes)\n```\ndomain: systems â†’ gears âš™\ndomain: web â†’ globe ğŸŒ (or â—¯â”€â—¯â”€â—¯)\nlanguage: zig â†’ âš¡ or diamond â—‡\nstyle: methodical â†’ grid patterns â”¼â”¼â”¼\n```\n\n## Algorithm Sketch\n\n```zig\npub fn generateMask(masque: Masque) Mask {\n    const seed = hashMasque(masque);\n    var rng = std.rand.DefaultPrng.init(seed);\n    \n    return Mask{\n        .shape = selectShape(rng, masque.index),\n        .eyes = deriveEyes(masque.skills[0..2]),\n        .expression = deriveExpression(masque.performance.score),\n        .border = deriveBorder(masque.ring),\n        .colors = deriveColors(masque.ring),\n        .decorations = deriveDecorations(masque.attributes),\n        .title = masque.name,\n    };\n}\n\npub fn render(mask: Mask, writer: anytype) !void {\n    // Output ANSI-colored unicode to writer\n}\n```\n\n## CLI\n\n```bash\nmasque portrait codesmith       # Render Codesmith's mask\nmasque portrait --all           # Gallery of all masks\nmasque portrait codesmith --seed-debug  # Show what attributes affected what\n```\n\n## Properties\n\n1. **Deterministic**: Same masque always renders the same mask\n2. **Unique**: Different masques render visually distinct masks\n3. **Meaningful**: Visual elements map to masque attributes\n4. **Beautiful**: It should look good in a terminal\n\n## Stretch Goals\n\n- Animated idle state (subtle breathing/glow)\n- Side-by-side comparison of two masks\n- Export to SVG for use outside terminal\n- \"Mask gallery\" TUI browser\n\n## Fractal Connection\n\nThis is L2 (Masque level) visualization. The mask embodies:\n- Identity (shape, title)\n- Capability (eyes from skills)\n- Trust (border from ring)  \n- Reputation (expression from ratings)\n\nAll derived from L1 session data aggregated up.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:59:37.803397-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.896228-06:00","closed_at":"2026-01-17T00:32:02.896228-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-kwl","title":"Implement performance rating system","description":"## Context\n\nPerformance ratings evaluate masques against their claimed skills. The rating system uses contribution symbols:\n\n| Symbol | Meaning | Description |\n|--------|---------|-------------|\n| + | Additive | Steady, incremental contribution |\n| - | Negative | Detracts from community goals |\n| / | Dividing | Fragments effort, creates friction |\n| * | Multiplicative | Force multiplier, amplifies others |\n| e | Exponential | Catalytic, transforms what's possible |\n\n## Fractal Position\n\n**Level**: Evaluation (crosses all levels)\n**Inputs**: Session outcomes, skill claims\n**Outputs**: Aggregated scores at Masque/Skill/Ring/System levels\n\nRating flows upward:\n- Session rating â†’ aggregates to Masque score\n- Masque scores â†’ inform Skill reliability  \n- Skill reliability â†’ affects Ring health\n- Ring health â†’ system-wide metrics\n\n## Implementation\n\n### Rating at Doff Time\nAlready captured in session tracking (masque-njr):\n```bash\nmasque doff --rate '*' --notes \"Excellent teaching, clear explanations\"\n```\n\n### Standalone Rating Command\nFor rating outside of session context:\n```bash\nmasque rate \u003cname\u003e \u003c+|-|/|*|e\u003e [--notes \"...\"]\n```\n\n### Score Aggregation\n\nCurrent score for a masque = most recent rating (simple)\nOR weighted recency (decay older ratings)\nOR mode of last N ratings\n\nStore in performance.history array in masque JSON? Or separate events table?\n\n## Queries Enabled\n\n```sql\n-- Masque level: rating distribution\nSELECT rating, count(*) FROM sessions \nWHERE masque_name = 'Codesmith' GROUP BY rating;\n\n-- Skill level: do experts outperform competents?\nSELECT s.level, avg(rating_numeric(rating))\nFROM sessions \nJOIN masque_skills s ON ...\nGROUP BY s.level;\n\n-- Ring level: which tier produces best outcomes?\nSELECT m.ring, avg(rating_numeric(rating))\nFROM sessions JOIN masques m ON ...\nGROUP BY m.ring;\n```\n\n## Open Questions\n\n- Should ratings update the masque JSON file, or live only in events?\n- How to convert symbols to numeric for averaging? (+:1, -:-1, /:0, *:2, e:3)?\n- Who rates? Self-assessment? External evaluator? Both?\n- Rating disputes/appeals?\n\n## Success Criteria\n\n- Ratings persist across sessions\n- Can query rating distribution at any fractal level\n- Masque \"reputation\" emerges from aggregated ratings","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:41:52.872409-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.901361-06:00","closed_at":"2026-01-17T00:32:02.901361-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
{"id":"masque-njr","title":"Implement session tracking (don/doff)","description":"## Context\n\nSessions are the atomic unit of the fractal observability model. A session is one don/doff cycle â€” an agent assumes a masque, does work, then releases it.\n\n## Fractal Position\n\n**Level**: Session (L1 â€” the base level)\n**Aggregates up to**: Masque (L2), Skill (L3), Ring (L4), System (L5)\n\nEvery metric at higher levels is an aggregation of session data. Sessions are the source of truth for:\n- How long masques are worn\n- What intents are claimed vs accomplished  \n- Performance ratings\n- Usage patterns\n\n## Data Model\n\n```\nevents/sessions.parquet (append-only)\nâ”œâ”€â”€ id: uuid\nâ”œâ”€â”€ masque_name: string\nâ”œâ”€â”€ masque_version: string\nâ”œâ”€â”€ started_at: timestamp\nâ”œâ”€â”€ ended_at: timestamp (null while active)\nâ”œâ”€â”€ intent: string\nâ”œâ”€â”€ rating: enum (+|-|/|*|e) (null until doff)\nâ”œâ”€â”€ notes: string (optional evaluator notes)\nâ””â”€â”€ metadata: json (extensible)\n```\n\n## Implementation\n\n### `masque don \u003cname\u003e --intent \"...\"`\n1. Validate masque exists\n2. Validate intent against allowed/denied patterns\n3. Create session record with started_at = now()\n4. Store active session ID (where? env var? file? TBD)\n5. Output the masque lens to stdout (for agent to internalize)\n\n### `masque doff [--rate +|-|/|*|e] [--notes \"...\"]`\n1. Find active session\n2. Set ended_at = now()\n3. Set rating if provided\n4. Append to sessions.parquet\n5. Clear active session\n\n## Open Questions\n\n- Where to store active session state? Options:\n  - Environment variable (MASQUE_SESSION_ID)\n  - File (.masque/active-session)\n  - Database table (current_sessions)\n- Multiple concurrent sessions? Probably not for v1.\n- Session timeout/auto-doff?\n\n## Success Criteria\n\n- `don` creates a session and outputs the lens\n- `doff` closes the session with optional rating\n- Session data persists in parquet for querying","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T15:41:28.166957-06:00","created_by":"chris","updated_at":"2026-01-17T00:32:02.902108-06:00","closed_at":"2026-01-17T00:32:02.902108-06:00","close_reason":"Clearing backlog - TUI is finishing touch, fractal stuff deprecated"}
